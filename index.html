<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <script type="module" src="./vendor/spline-viewer/build/spline-viewer.js"></script>
  <style>
    html, body { margin:0; height:100%; background:transparent; }
    #outer { position:relative; height:180vh; }  /* internal scroll */
    #sticky { position:sticky; top:0; height:100vh; }
    spline-viewer { width:100%; height:100%; display:block; }

    /* Hide scrollbars but keep scrolling (cross-browser) */
    html, body { -ms-overflow-style: none; scrollbar-width: none; }
    html::-webkit-scrollbar, body::-webkit-scrollbar { width: 0; height: 0; display: none; }
  </style>
</head>
<body>
  <section id="outer">
    <div id="sticky">
      <spline-viewer id="viewer" url="./scene.splinecode" events-target="local"></spline-viewer>
    </div>
  </section>

  <script type="module">
    const qp = new URLSearchParams(location.search);
    const outer = document.getElementById('outer');
    outer.style.height = qp.get('scrollpx')
      ? parseInt(qp.get('scrollpx'),10) + 'px'
      : `calc(${parseFloat(qp.get('scrollvh')||'180')} * 1vh)`;

    if (qp.get('external') === '1') {
      window.addEventListener('message', (e) => {
        if (!e?.data || e.data.type !== 'SCROLL_PROGRESS') return;
        const max = document.documentElement.scrollHeight - innerHeight;
        document.documentElement.scrollTop = e.data.progress * Math.max(0, max);
      });
    }
  </script>
</body>
</html>
